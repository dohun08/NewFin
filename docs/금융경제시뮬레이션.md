# NewFin 코인 & 투자 시스템 구현 요청

## 📋 개요
Flutter로 개발 중인 NewFin 앱에 **학습 코인 보상 시스템**과 **가상 투자 시뮬레이터**를 구현해주세요. 사용자가 금융 학습 활동(뉴스 읽기, 퀴즈 풀기 등)으로 코인을 벌고, 이 코인으로 주식/환율/코인 등에 투자하면서 경제 시스템을 체험하도록 설계합니다.

---

## 🎯 전체 시스템 구조

```
학습 활동 (뉴스, 퀴즈, 로그인 등)
    ↓
💰 코인 획득 (NewCoin)
    ↓
투자 시장 (주식, 환율, 가상 코인)
    ↓
수익/손실 발생
    ↓
포트폴리오 관리 & 학습
```

---

## 💰 Part 1: 코인 시스템

### 1-1. 코인 획득 방법

**일일 활동 보상:**
```
┌─────────────────────────────────────┐
│  💰 오늘 획득 가능한 코인            │
│  ────────────────────────────────   │
│                                      │
│  ☑️ 로그인 보너스        +10 코인   │
│  ☐ 뉴스 1개 읽기         +20 코인   │
│  ☐ 뉴스 2개 읽기         +50 코인   │
│  ☐ 퀴즈 1세트 풀기       +30 코인   │
│  ☐ 퀴즈 만점             +50 코인   │
│  ☐ 단어 5개 학습         +15 코인   │
│  ☐ 연속 3일 학습         +100 코인  │
│                                      │
│  오늘 획득: 60 / 275 코인           │
└─────────────────────────────────────┘
```

**보상 규칙:**
- 로그인: 10 코인 (매일 자동)
- 뉴스 읽기 (요약 보기): 20 코인 (1개당)
- 뉴스 2개 이상: 보너스 +10 코인
- 퀴즈 풀기: 30 코인 (1세트당)
- 퀴즈 만점 (100%): 보너스 +20 코인
- 단어 학습: 3 코인 (1개당)
- 단어 5개 이상: 보너스 +15 코인
- 연속 학습: 
  - 3일: 100 코인
  - 7일: 300 코인
  - 14일: 700 코인
  - 30일: 2000 코인

**제한 규칙:**
- 각 보상은 하루 1회만 지급
- 뉴스는 최대 5개까지만 코인 지급
- 퀴즈는 최대 3세트까지만 코인 지급
- 중복 방지: 같은 뉴스/퀴즈 재시도 시 코인 미지급

### 1-2. 코인 표시 & 관리

**상단 코인 잔액 바:**
```
┌─────────────────────────────────────┐
│  [NF 로고]   💰 1,250 NC   [👤]     │
│                    ↑                 │
│              탭하면 코인 상세         │
└─────────────────────────────────────┘
```

**코인 상세 페이지:**
```
┌─────────────────────────────────────┐
│  [← 뒤로]   내 코인                  │
├─────────────────────────────────────┤
│                                      │
│  💰 현재 보유                        │
│  ────────────────────────────────   │
│  1,250 NC (NewCoin)                 │
│                                      │
│  📊 코인 내역                        │
│  ────────────────────────────────   │
│                                      │
│  📅 2024.11.28                       │
│  + 50 NC  뉴스 2개 읽기 완료         │
│  + 30 NC  퀴즈 풀기 완료             │
│  - 200 NC 삼성전자 주식 구매         │
│                                      │
│  📅 2024.11.27                       │
│  + 100 NC 연속 3일 학습 보너스       │
│  + 20 NC  뉴스 1개 읽기              │
│                                      │
│  ... (스크롤)                        │
└─────────────────────────────────────┘
```

**구현 사항:**
- 모든 화면 상단에 코인 잔액 표시
- 코인 획득 시 토스트 메시지 + 애니메이션
- 코인 부족 시 안내 메시지
- 코인 히스토리 (획득/사용 내역)

---

## 📈 Part 2: 투자 시장 시스템

### 2-1. 투자 시장 메인 화면

**레이아웃:**
```
┌─────────────────────────────────────┐
│  [← 뒤로]   투자하기   💰 1,250 NC  │
├─────────────────────────────────────┤
│  [탭] 주식 | 환율 | 가상코인         │
├─────────────────────────────────────┤
│                                      │
│  📊 주식 시장 (실시간)               │
│                                      │
│  ┌─────────────────────────────┐    │
│  │ 삼성전자                     │    │
│  │ 72,500원  ▲ 1,200 (+1.68%)  │    │
│  │ [200 NC로 매수]              │    │
│  └─────────────────────────────┘    │
│                                      │
│  ┌─────────────────────────────┐    │
│  │ 카카오                       │    │
│  │ 45,800원  ▼ 300 (-0.65%)    │    │
│  │ [150 NC로 매수]              │    │
│  └─────────────────────────────┘    │
│                                      │
│  ... (더보기)                        │
└─────────────────────────────────────┘
```

### 2-2. 주식 투자 (실시간 데이터)

**종목 리스트:**
- 삼성전자
- SK하이닉스
- 현대차
- 카카오
- 네이버
- LG에너지솔루션
- POSCO홀딩스
- KB금융

**주식 데이터 소스:**
- 실시간 주가는 **한국거래소 API** 또는 **공공데이터 주가 API** 사용
- 대안: 야후 파이낸스 API, Alpha Vantage (무료)
- 1분마다 자동 갱신

**매수/매도 시스템:**
```
┌─────────────────────────────────────┐
│  삼성전자 매수                       │
├─────────────────────────────────────┤
│                                      │
│  현재가: 72,500원                    │
│  보유 코인: 1,250 NC                │
│                                      │
│  투자 금액 선택:                     │
│  ┌─────────────────────────────┐    │
│  │ [100 NC] [200 NC] [500 NC]  │    │
│  │ [직접 입력: ___ NC]          │    │
│  └─────────────────────────────┘    │
│                                      │
│  100 NC = 실제 7,250원 상당          │
│  (1 NC = 실제 72.5원 환산)           │
│                                      │
│  예상 매수량: 약 0.001주             │
│                                      │
│  [매수하기]  [취소]                  │
└─────────────────────────────────────┘
```

**환산 비율:**
- 1 NC = 실제 주가의 1/100 (편의상)
- 예: 삼성전자 72,500원 → 200 NC로 매수 가능
- 소수점 주식 허용 (0.001주 단위)

**주식 보유 현황:**
```
┌─────────────────────────────────────┐
│  📊 내 주식 포트폴리오               │
│                                      │
│  총 투자금: 500 NC                  │
│  현재 평가액: 620 NC                │
│  수익률: +120 NC (+24%) 🔥          │
│                                      │
│  ┌─────────────────────────────┐    │
│  │ 삼성전자  0.003주             │    │
│  │ 매수가: 72,500원 (200 NC)    │    │
│  │ 현재가: 74,000원 (220 NC)    │    │
│  │ 수익: +20 NC (+10%) ▲        │    │
│  │ [매도하기]                   │    │
│  └─────────────────────────────┘    │
│                                      │
│  ┌─────────────────────────────┐    │
│  │ 카카오  0.006주               │    │
│  │ 매수가: 45,800원 (300 NC)    │    │
│  │ 현재가: 48,000원 (360 NC)    │    │
│  │ 수익: +60 NC (+20%) ▲        │    │
│  │ [매도하기]                   │    │
│  └─────────────────────────────┘    │
└─────────────────────────────────────┘
```

### 2-3. 환율 투자

**환율 거래 종목:**
- USD (미국 달러)
- JPY (일본 엔)
- EUR (유로)
- CNY (중국 위안)

**환율 데이터 소스:**
- **한국수출입은행 환율 API** (실시간, 무료)
- 10분마다 자동 갱신

**환율 투자 화면:**
```
┌─────────────────────────────────────┐
│  💵 환율 거래                        │
│                                      │
│  ┌─────────────────────────────┐    │
│  │ USD (미국 달러)              │    │
│  │ 1,320원  ▼ 5원 (-0.38%)     │    │
│  │                              │    │
│  │ 100 NC로 매수 시:            │    │
│  │ → 약 $7.58 획득              │    │
│  │ [매수하기]                   │    │
│  └─────────────────────────────┘    │
│                                      │
│  ┌─────────────────────────────┐    │
│  │ JPY (일본 엔)                │    │
│  │ 9.2원  ▲ 0.1원 (+1.1%)      │    │
│  │ [매수하기]                   │    │
│  └─────────────────────────────┘    │
└─────────────────────────────────────┘
```

**환율 보유 현황:**
```
┌─────────────────────────────────────┐
│  💵 내 환율 포트폴리오               │
│                                      │
│  ┌─────────────────────────────┐    │
│  │ USD $10.50                   │    │
│  │ 매수가: 1,330원 (150 NC)     │    │
│  │ 현재가: 1,320원 (145 NC)     │    │
│  │ 손실: -5 NC (-3.3%) ▼        │    │
│  │ [매도하기]                   │    │
│  └─────────────────────────────┘    │
└─────────────────────────────────────┘
```

### 2-4. 가상 코인 투자

**가상 코인 종류:**
- BTC (비트코인)
- ETH (이더리움)
- XRP (리플)

**코인 데이터 소스:**
- **CoinGecko API** (무료)
- 실시간 가격 (1분 갱신)

**특징:**
- 변동성이 커서 고위험 고수익
- 주식/환율보다 빠른 학습 가능
- Gemini API로 "왜 오르고 내렸는지" 설명 제공

**가상 코인 화면:**
```
┌─────────────────────────────────────┐
│  🪙 가상 코인                        │
│                                      │
│  ┌─────────────────────────────┐    │
│  │ ₿ BTC (비트코인)             │    │
│  │ $43,250  ▲ $820 (+1.93%)    │    │
│  │                              │    │
│  │ 📊 [오늘 왜 올랐을까?]       │    │
│  │ [200 NC로 매수]              │    │
│  └─────────────────────────────┘    │
│                                      │
│  ┌─────────────────────────────┐    │
│  │ Ξ ETH (이더리움)             │    │
│  │ $2,285  ▼ $45 (-1.93%)      │    │
│  │ [150 NC로 매수]              │    │
│  └─────────────────────────────┘    │
└─────────────────────────────────────┘
```

**"오늘 왜 올랐을까?" 기능:**
- 버튼 클릭 시 Gemini API 호출
- 프롬프트: "비트코인이 오늘 1.93% 상승했습니다. 최근 암호화폐 시장 동향을 바탕으로 10대가 이해할 수 있도록 쉽게 설명해주세요. 2-3문장으로."
- 결과를 다이얼로그로 표시

---

## 📊 Part 3: 포트폴리오 & 학습 시스템

### 3-1. 통합 포트폴리오 화면

```
┌─────────────────────────────────────┐
│  [← 뒤로]   내 투자 현황             │
├─────────────────────────────────────┤
│                                      │
│  💰 총 자산                          │
│  ────────────────────────────────   │
│  1,850 NC                           │
│                                      │
│  코인 잔액: 750 NC                  │
│  투자 중: 1,100 NC                  │
│  총 수익: +100 NC (+5.4%) ▲         │
│                                      │
├─────────────────────────────────────┤
│  📊 자산 분포                        │
│  [파이 차트]                         │
│  • 주식: 60% (600 NC)               │
│  • 환율: 25% (250 NC)               │
│  • 가상코인: 15% (150 NC)           │
│  • 현금: 40% (750 NC)               │
├─────────────────────────────────────┤
│  📈 수익률 그래프                    │
│  [선 그래프 - 일주일 추이]           │
│                                      │
│      ╱╲                              │
│     ╱  ╲  ╱╲                        │
│  ───────────────                    │
│  월 화 수 목 금 토 일                │
├─────────────────────────────────────┤
│  🔥 보유 종목                        │
│  ┌─────────────────────────────┐    │
│  │ 삼성전자  +10% ▲              │    │
│  │ 카카오    +20% ▲              │    │
│  │ USD       -3% ▼               │    │
│  └─────────────────────────────┘    │
└─────────────────────────────────────┘
```

### 3-2. 투자 교육 & 인사이트

**Gemini 활용 학습 기능:**

#### 기능 1: "내 포트폴리오 분석"
```
[AI 분석] 버튼 클릭 시:

Gemini 프롬프트:
"사용자의 포트폴리오:
- 주식 60% (삼성전자 +10%, 카카오 +20%)
- 환율 25% (USD -3%)
- 가상코인 15% (BTC +5%)

10대 투자 초보자에게 이 포트폴리오를 분석하고:
1. 잘한 점 1가지
2. 개선할 점 1가지
3. 다음 투자 추천 1가지
쉽게 설명해주세요."

응답 예시:
"👍 잘한 점: 카카오 투자가 좋았네요! 20% 수익은 대단해요.

💡 개선할 점: 달러가 손해를 보고 있어요. 환율은 변동이 적어서 
단기보다는 장기 투자가 유리합니다.

📈 추천: 주식 비중이 높으니 안정적인 은행주나 배당주를 
추가해보는 건 어떨까요?"
```

#### 기능 2: "이 종목 설명해줘"
```
종목 클릭 → [설명 듣기] 버튼

Gemini 프롬프트:
"삼성전자는 어떤 회사인지, 왜 투자하면 좋은지 
10대에게 2-3문장으로 쉽게 설명해주세요."

응답 예시:
"삼성전자는 스마트폰과 반도체를 만드는 세계적인 기업이에요.
특히 반도체는 컴퓨터, 휴대폰 등 모든 전자기기에 필수라서 
수요가 꾸준합니다. 안정적인 대기업 투자로 좋아요!"
```

#### 기능 3: "시장 상황 알려줘"
```
메인 화면 상단 [오늘의 시장] 버튼

Gemini 프롬프트:
"오늘 코스피는 +0.6%, 달러는 -0.4% 변동했습니다.
10대에게 오늘 시장 상황을 2-3문장으로 요약해주세요."

응답 예시:
"오늘은 주식 시장이 조금 올랐어요. 반면 달러는 약간 떨어졌네요.
이는 투자자들이 안전한 달러보다 주식에 더 관심을 보였다는 뜻이에요!"
```

### 3-3. 투자 일지

**자동 기록:**
```
┌─────────────────────────────────────┐
│  📝 내 투자 일지                     │
│                                      │
│  📅 2024.11.28                       │
│  • 삼성전자 매수 (200 NC)           │
│  • 현재 +10 NC 수익                 │
│  • AI 분석: "좋은 선택이에요!"      │
│                                      │
│  📅 2024.11.27                       │
│  • USD 매수 (150 NC)                │
│  • 현재 -5 NC 손실                  │
│  • 교훈: 환율은 단기 변동이 적음    │
└─────────────────────────────────────┘
```

---

## 🎮 Part 4: 게임화 요소

### 4-1. 투자 미션

**일일 투자 미션:**
```
┌─────────────────────────────────────┐
│  🎯 오늘의 투자 미션                 │
│                                      │
│  ☐ 주식 1개 매수하기   (+50 NC)     │
│  ☐ 수익률 +5% 달성    (+100 NC)    │
│  ☐ AI 분석 듣기       (+20 NC)     │
└─────────────────────────────────────┘
```

### 4-2. 투자 랭킹

**전체 사용자 랭킹:**
```
┌─────────────────────────────────────┐
│  🏆 이번 주 수익률 랭킹              │
│                                      │
│  1위 🥇 user123    +35.2%           │
│  2위 🥈 investor_a +28.9%           │
│  3위 🥉 금융왕     +24.1%           │
│  ...                                 │
│  50위 나 (윤도훈)   +5.4%           │
└─────────────────────────────────────┘
```

### 4-3. 투자 뱃지

**획득 조건:**
- 💰 첫 투자: 처음 매수
- 📈 수익 마스터: +10% 수익 달성
- 🔥 연속 투자: 7일 연속 거래
- 🎯 백전백승: 10회 연속 수익
- 💎 큰손: 1,000 NC 투자
- 🌟 분산 투자: 5개 이상 종목 보유

---

## 💡 Part 5: 경제 학습 강화

### 5-1. 실시간 뉴스 연동

**투자 화면에 관련 뉴스 표시:**
```
┌─────────────────────────────────────┐
│  삼성전자 (+1.68%)                  │
│                                      │
│  📰 관련 뉴스:                       │
│  "삼성전자, AI 반도체 수주 확대"    │
│  [요약 보기] (+20 NC)               │
└─────────────────────────────────────┘
```

- 경제 뉴스 API에서 종목 관련 뉴스 필터링
- 뉴스 요약 보기 시 코인 지급
- Gemini로 "이 뉴스가 주가에 미치는 영향" 설명

### 5-2. 용어 학습 팝업

**투자 중 등장하는 용어 자동 해설:**
```
"매수" 클릭 시:
→ 팝업: "매수는 주식을 사는 행위예요. 
         주가가 오를 것 같을 때 하죠!"
→ 용어 사전에 자동 저장
```

---

## 🛠 구현 가이드

### 필요한 API

1. **주식 데이터:**
   - 한국거래소 API
   - 공공데이터 주식시세 API
   - 대안: Yahoo Finance, Alpha Vantage

2. **환율 데이터:**
   - 한국수출입은행 환율 API

3. **가상 코인 데이터:**
   - CoinGecko API (무료)

4. **AI 설명:**
   - Gemini API (이미 사용 중)

5. **뉴스:**
   - 경제 뉴스 요약 API (이미 보유)

### 데이터베이스 스키마

**coins 테이블:**
- user_id, amount, date, type (획득/사용), description

**investments 테이블:**
- id, user_id, type (주식/환율/코인), symbol, 
  buy_price, buy_amount, buy_date, sell_price, sell_date

**portfolio 테이블:**
- user_id, total_coins, invested_amount, 
  profit_loss, update_date

### 실시간 업데이트

- 주식/환율/코인 가격은 1분마다 갱신
- WebSocket 또는 타이머로 구현
- 보유 종목 수익률 자동 계산

---

## 🎯 핵심 학습 포인트

### 사용자가 배우는 것:
1. **투자 기본 개념**
   - 매수/매도, 수익률, 손실
   - 리스크와 수익의 관계

2. **시장 이해**
   - 주가가 왜 오르고 내리는지
   - 환율 변동 원리
   - 뉴스가 시장에 미치는 영향

3. **포트폴리오 관리**
   - 분산 투자의 중요성
   - 장기 vs 단기 투자
   - 손절/익절 타이밍

4. **실전 경험**
   - 실제 돈 없이 안전하게 체험
   - 성공과 실패 모두 경험
   - AI 피드백으로 학습

---

## ✅ MVP 우선순위

### Phase 1 (필수)
1. 코인 획득 시스템 (뉴스, 퀴즈 보상)
2. 주식 투자 (5개 종목)
3. 포트폴리오 기본 화면

### Phase 2 (중요)
1. 환율 투자
2. 가상 코인 투자
3. Gemini AI 분석

### Phase 3 (추가)
1. 투자 미션
2. 랭킹 시스템
3. 뱃지 & 업적

---

## 🎨 UI/UX 포인트

- 코인 획득 시 **애니메이션** (코인이 쌓이는 효과)
- 매수/매도 시 **확인 다이얼로그** (실수 방지)
- 수익: 초록색, 손실: 빨간색
- 실시간 변동: 깜빡이는 효과
- 그래프 터치 → 해당 시점 정보 표시

---

이 시스템으로 사용자들이 **재미있게 코인 모으고 → 투자 체험 → 경제 학습**의 선순환을 경험할 수 있어요! 🚀

특히 Gemini API로 "왜 이렇게 됐는지" 계속 설명해주면 학습 효과가 배가 될 거예요!